# ══════════════════════════════════════════════════════════════════════════════
#  Environment Variables — Local Development Defaults
# ══════════════════════════════════════════════════════════════════════════════
#
#  Quick start:
#    cp .env.example .env
#    docker compose -f docker-compose.local.yml up -d
#
#  Everything below has working dev defaults. Copy this file to .env and
#  you're ready to go — no edits required for local development.
#
#  The init script does this copy automatically (and generates a random JWT
#  secret). If you're on a second machine where the init script has already
#  run and been deleted, just copy this file manually.
#
#  To override a value, edit .env (not this file). .env is git-ignored.
#
#  How Docker Compose reads these values:
#    • ${VAR} references in docker-compose.local.yml are resolved from .env
#    • The API container also loads .env via env_file, so any ASP.NET config
#      key (e.g. Authentication__Jwt__ExpiresInMinutes=300) set here takes
#      effect without editing docker-compose or appsettings files.
#
#  Precedence (highest → lowest):
#    1. docker compose run --env                          (CLI override, rare)
#    2. docker-compose.local.yml `environment` block      (interpolated from .env)
#    3. .env via `env_file` directive                     (pass-through to container)
#    4. appsettings.{Environment}.json                    (ASP.NET config layering)
#    5. appsettings.json                                  (base defaults)
#
#  PRODUCTION: Do not use these values. Generate strong secrets and set them
#  through your deployment tooling (Docker Swarm secrets, K8s ConfigMaps, etc.).
# ══════════════════════════════════════════════════════════════════════════════

# ── Core ─────────────────────────────────────────────────────────────────────
# ASP.NET runtime environment. Controls config layering and error detail.
# ASPNETCORE_ENVIRONMENT=Development

# ── Database (PostgreSQL) ────────────────────────────────────────────────────
POSTGRES_USER=admin
POSTGRES_PASSWORD=pwd
# POSTGRES_DB={INIT_PROJECT_SLUG}

# Full connection string override (not needed locally — composed automatically):
# ConnectionStrings__Database=Host=localhost;Port=5432;Database=myapp;Username=admin;Password=pwd

# ── Redis ────────────────────────────────────────────────────────────────────
REDIS_PASSWORD=redis-dev-password

# Redis connection string override (not needed locally):
# Caching__Redis__ConnectionString=redis:6379
# Caching__Redis__UseSsl=false

# ── Authentication (JWT) ─────────────────────────────────────────────────────
# Static dev key. The init script replaces this with a random secret.
# For local development, any string >= 32 characters works fine.
JWT_SECRET_KEY=super-secret-jwt-key-for-local-development-only-do-not-use-in-production

# Token lifetimes (defaults in appsettings.Development.json are generous):
# Authentication__Jwt__ExpiresInMinutes=100
# Authentication__Jwt__RefreshToken__ExpiresInDays=7
# Authentication__Jwt__Issuer=MyProjectIssuer
# Authentication__Jwt__Audience=MyProjectAudience

# ── CORS ─────────────────────────────────────────────────────────────────────
# Development allows all origins (set in appsettings.Development.json).
# Cors__AllowAllOrigins=false
# Cors__AllowedOrigins__0=https://your-domain.com

# ── Rate Limiting ────────────────────────────────────────────────────────────
# RateLimiting__Global__PermitLimit=120
# RateLimiting__Global__Window=00:01:00

# ── Logging (Serilog → Seq) ──────────────────────────────────────────────────
# Serilog__MinimumLevel__Default=Information

# ── Docker Compose Ports ─────────────────────────────────────────────────────
# Override to resolve port conflicts when running multiple projects.
# Defaults are baked into docker-compose.local.yml during init.
# FRONTEND_PORT={INIT_FRONTEND_PORT}
# API_PORT={INIT_API_PORT}
# DB_PORT={INIT_DB_PORT}
# REDIS_PORT={INIT_REDIS_PORT}
# SEQ_PORT={INIT_SEQ_PORT}

# ── Frontend ─────────────────────────────────────────────────────────────────
# URL the frontend container uses to reach the backend API.
# To debug the backend in Rider/VS while the frontend runs in Docker,
# uncomment and point to the host machine:
# API_URL=http://host.docker.internal:5142

# Additional origins allowed through the SvelteKit API proxy CSRF check.
# Comma-separated. Use when accessing the frontend through a reverse proxy,
# tunnel (ngrok, Tailscale), or any URL that differs from the app's own origin.
# ALLOWED_ORIGINS=https://abc123.ngrok-free.app
